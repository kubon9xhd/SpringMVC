package DocterController;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.*;

import javax.sound.midi.Soundbank;

import Model.DoctorModel;
import Ultil.Validation;

public class DocterController {
	public List<DoctorModel> list = new ArrayList<DoctorModel>();

	public void createDoctor() {
		DoctorModel model = new DoctorModel();
		int id = Validation.getId(list);
		model.setId(id);
		list.add(model);
		commonDoctor(list.get(id - 1));
		System.out.println("Crate done!");

	}

	public void editDoctor() {
		int id = getInteger("Enter Doctor id: ");
		if (isId(id)) {
			commonDoctor(list.get(id - 1));
			System.out.println("Edit done!");
		} else {
			System.out.println("Edit fail! Id does not exist");
		}

	}

	public void commonDoctor(DoctorModel model) {
		String name = getName();
		model.setName(name);

		String date = getDate();
		model.setDateOfBirth(date);

		String specialization = getSpecial();
		model.setSpecialization(specialization);

		int availability = getAvailability();
		model.setAvailability(availability);

		String email = getEmail();
		model.setEmail(email);

		String phone = getPhone();
		model.setMobile(phone);
	}

	public String getName() {
		String name = getString("Enter Doctor Name: ");
		while (Validation.isRightName(name)) {
			System.out.println(
					"Please Enter, Name must have greater than 0 characters and less than or equal to 50 characters.");
			name = getString("Enter Doctor Name: ");
		}
		return name;
	}

	public String getDate() {
		String date = getString("Enter date of birth follow format dd/MM/yyyy: ");
		while (!Validation.isRightDateOfBirth(date)) {
			System.out.println("Please, Enter date in format.");
			date = getString("Enter date of birth follow format dd/MM/yyyy: ");
		}
		return date;
	}

	public String getSpecial() {
		String specialization = getString("Enter Specialization: ");
		while (!Validation.isSpecialization(specialization)) {
			System.out.println(
					"Please, Enter Specialization must have greater than 0 characters and less than or equal to 255 characters.");

			specialization = getString("Enter Specialization: ");
		}
		return specialization;
	}

	public int getAvailability() {
		int availability = getInteger("Enter Availability (0/1/2/3): ");
		while (!Validation.isAvailability(availability)) {

			availability = getInteger("Enter Availability (0/1/2/3): ");
		}
		return availability;
	}

	public String getEmail() {
		String email = getString("Enter Eamil: ");
		while (!Validation.isEmail(email)) {
			System.out.println("Please, Enter email right format has @ and domain after that");
			email = getString("Enter Eamil: ");
		}
		return email;
	}

	public String getPhone() {
		String phone = getString("Enter phone: ");
		while (!Validation.isMobile(phone)) {
			phone = getString("Enter phone: ");
		}
		return phone;
	}

	public boolean deleteDoctor(int id) {
		if (isId(id)) {
			for (DoctorModel doctorModel : list) {
				if (doctorModel.getId() == id) {
					list.remove(doctorModel);
					return true;
				}
			}
		}
		return false;
	}

	public boolean findDoctor(int id, String name) {
		if (isId(id)) {
			for (DoctorModel doctorModel : list) {
				System.out.println(doctorModel.getEmail());
				if (doctorModel.getName().equalsIgnoreCase(name)) {
					return true;
				}
			}
		}
		return false;
	}

	public void sortDoctor() {
		Collections.sort(list, new Comparator<DoctorModel>() {
			public int compare(DoctorModel o1, DoctorModel o2) {
				SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
				Date date1 = null, date2 = null;
				try {
					date1 = sdf.parse(o1.getDateOfBirth());
					date2 = sdf.parse(o2.getDateOfBirth());
				} catch (ParseException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				return date1.compareTo(date2);
			}
		});
	}

	public boolean isId(int id) {
		for (DoctorModel doctorModel : list) {
			if (doctorModel.getId() == id) {
				return true;
			}
		}
		return false;

	}

	public static String getString(String str) {
		Scanner sc = new Scanner(System.in);
		System.out.println(str);
		String strs = sc.nextLine();
		return strs;
	}

	private int getInteger(String str) {
		Scanner sc = new Scanner(System.in);
		while (true) {
			System.out.println(str);
			try {
				int number = Integer.parseInt(sc.nextLine());
				if (number < 0)
					throw new Exception();
				return number;
			} catch (Exception e) {
				System.out.println("Error! Please, Enter positive integer number");
			}
		}
	}

	public void main(String args[]) {
		while (true) {
			System.out.println("1.Create a Doctor\r\n" + "2.Edit a Doctor Information\r\n" + "3.Delete a Doctor\r\n"
					+ "4.Search doctor by ID and by Name\r\n" + "5.Sort doctor by DateOfBirth");
			int choice = getInteger("Enter your choice: ");
			switch (choice) {
			case 1:
				createDoctor();
				break;
			case 2:
				editDoctor();
				break;
			case 3:
				int id = getInteger("Enter Doctor id: ");
				deleteDoctor(id);
				break;
			case 4:
				int idFind = getInteger("Enter Doctor id: ");
				String name = getString("Enter Doctor name: ");
				if (findDoctor(idFind, name)) {
					for (DoctorModel doctorModel : list) {
						if (doctorModel.getId() == idFind) {
							doctorModel.toString();
							break;
						}
					}
				}
				break;
			case 5:
				sortDoctor();
				break;
			default:
				break;
			}
		}
	}
}
